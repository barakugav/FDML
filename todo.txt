fix timeout and process leak handling
tests
