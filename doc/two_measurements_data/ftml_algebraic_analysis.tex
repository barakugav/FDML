\documentclass[11pt]{article}
\usepackage[margin=0.7in]{geometry}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage[american]{babel}
\usepackage[latin1]{inputenc}
\usepackage{xparse}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage[export]{adjustbox}
\usepackage{algpseudocode}
\usepackage{wrapfig}
\usepackage{tikz,graphicx}
\usetikzlibrary{patterns,calc,arrows,arrows.meta,angles,quotes}
\usetikzlibrary{decorations.pathreplacing,calligraphy,babel}
\usepackage[framemethod=tikz]{mdframed}
\usepackage[fleqn]{amsmath}
\tikzset{%
  point/.style={circle,inner sep=1.25pt,minimum size=1.25pt,draw,fill=#1},
  point/.default=red
}
\usepackage[caption=false,font=footnotesize]{subfig}
\newtheorem{remark}{Remark}
\newtheorem{example}{Example}
\newtheorem{observation}{Observation}
\newtheorem{func}{Function}
\newtheorem*{theorem*}{Theorem}
\title{Localization with Two Distance Measurements: Algebraic Analysis}
\date{}
\author{Efi Fogel}
\pagestyle{plain}
\definecolor{c0}{rgb}{0.2,0.4,0.67}
\definecolor{c1}{rgb}{0.67,0.4,0.12}
\definecolor{c2}{rgb}{0.53,0.6,0.13}
\definecolor{c3}{rgb}{0.53,0.53,0.4}
\begin{document}
\maketitle
\input{abstract}
\input{introduction}
\input{analysis}
%%%%%%%% General Case
\section{General Case}
\begin{align*}
  a_1 x_1 + b_1 y_1 + c_1 &= 0\\
  a_1 x_2 + b_1 y_2 + c_1 &= 0\\
  (x - x_1)^2 + (y - y_1)^2 &= d_1^2\\
  (x - x_2)^2 + (y - y_2)^2 &= d_2^2\\
  (x_2 - x_1)^2 + (y_2 - y_1)^2 &= d_1^2 + d_2^2 - 2 c d_1 d_2 = d_1^2 + d_2^2 - 2 k
\end{align*}
%%%%%%%% Without Translation
\section{Without Translation ($c_1 = c_2 = 0$)}
\begin{align*}
  y_1 & = m_1 x_1\\
  y_2 & = m_2 x_2\\
  (x - x_1)^2 + (y - m_1 x_1)^2 & = d_1^2\\
  (x - x_2)^2 + (y - m_2 x_2)^2 & = d_2^2\\
  (x_2 - x_1)^2 + (m_2 x_2 - m_1 x_1)^2 & = d_1^2 + d_2^2 - 2 k
\end{align*}
\begin{align*}
  x^2 + x_1^2 - 2 x x_1 + y^2 + m_1^2x_1^2 - 2 m_1 y x_1 &= d_1^2\\
  (1 + m_1^2) x_1^2 - 2 (x + m_1 y) x_1  + x^2 + y^2  &= d_1^2\\
  (1 + m_2^2) x_2^2 - 2 (x + m_2 y) x_2  + x^2 + y^2  &= d_2^2\\
  x_2^2 + x_1^2 - 2 x_1 x_2 + m_1^2 x_1^2 + m_2^2 x_2^2 - 2 m_1 m_2 x_1 x_2 &= d_1^2 + d_2^2 - 2 k\\
  (1 + m_1^2) x_1^2 + (1 + m_2^2) x_2^2 - 2 (1 + m_1 m_2) x_1 x_2 &= d_1^2 + d_2^2 - 2 k\\
\end{align*}
\begin{align*}
  2 (1 + m_1 m_2) x_1 x_2 - 2 (x + m_1 y) x_1 - 2 (x + m_2 y) x_2 + 2 x^2 + 2 y^2 &= 2 k\\
  (1 + m_1 m_2) x_1 x_2 - (x + m_1 y) x_1 - (x + m_2 y) x_2 + x^2 + y^2 - k &= 0\\
\end{align*}
%%%%%%%% x-aligned, no translation
\section{$x$-Axis Aligned, without translation}
\begin{align*}
  m_1 &= 0\\
  (1 + m_1 m_2) x_1 x_2 - (x + m_1 y) x_1 - (x + m_2 y) x_2 + x^2 + y^2 - k &= 0\\
  x_1 x_2 - x x_1 - (x + m_2 y) x_2 + x^2 + y^2 - k &= 0\\
\end{align*}
\begin{align*}
  (x - x_1)^2 + y^2 & = d_1^2\\
  (x - x_2)^2 + (y - m_2 x_2)^2 & = d_2^2\\
\end{align*}
\begin{align*}
  x_1 &= x \pm \sqrt{d_1^2 - y^2}\\
  x_2 &= \frac{x + m_2 y \pm \sqrt{(x + m_2 y)^2 - (1 + m_2^2)(x^2 + y^2 - d_2^2)}}{1 + m_2^2}\\
  &= \frac{x + m_2 y \pm \sqrt{(2 m_2 x y - y^2 + d_2^2 - m_2^2 x^2 + d_2^2 m_2^2}}{1 + m_2^2}\\
  &= \frac{x + m_2 y}{1 + m_2^2} + \sqrt{\frac{2 m_2 x y - y^2 + d_2^2 - m_2^2 x^2 + d_2^2 m_2^2}{(1 + m_2^2)^2}}
\end{align*}
%% Symbolic
\section{Symbolic}
\begin{align*}
  x_1 &= r_1 \pm \sqrt{s_1} = x \pm \sqrt{d_1^2 - y^2}\\
  x_2 &= r_2 \pm \sqrt{s_2}\\
\end{align*}
\begin{align*}
  x_1 x_2 - x x_1 - (x + m_2 y) x_2 + x^2 + y^2 - k &= 0\\
  (x \pm \sqrt{s_1}) (r_2 \pm \sqrt{s_2}) - x (x \pm \sqrt{s_1}) - (x + m_2 y) (r_2 \pm \sqrt{s_2}) + x^2 + y^2 - k &= 0\\
\end{align*}
\begin{align*}
  x r_2 \pm x \sqrt{s_2} \pm r_2 \sqrt{s_1} + \sqrt{s_1 s_2} - x^2 \mp x\sqrt{s_1} - r_2 (x + m_2 y) \mp (x + m_2 y)\sqrt{s_2} + x^2 + y^2 - k &= \\
  x r_2 \pm x \sqrt{s_2} \pm r_2 \sqrt{s_1} + \sqrt{s_1 s_2} \mp x\sqrt{s_1} - r_2 x - r_2 m_2 y \mp x \sqrt{s_2} \mp m_2 y\sqrt{s_2}  + y^2 - k &= \\
  \pm r_2 \sqrt{s_1} + \sqrt{s_1 s_2} \mp x\sqrt{s_1} - r_2 m_2 y \mp m_2 y\sqrt{s_2}  + y^2 - k &= 0\\
\end{align*}
\begin{align*}
  \mp x\sqrt{s_1} \pm r_2 \sqrt{s_1} \mp m_2 y \sqrt{s_2} + \sqrt{s_1 s_2} - r_2 m_2 y + y^2 - k &= 0\\
  \mp (x - r_2) \sqrt{s_1} \mp m_2 y \sqrt{s_2} + \sqrt{s_1 s_2} - r_2 m_2 y + y^2 - k &= 0\\
\end{align*}
Add $\pm (x - r_2) \sqrt{s_1} \pm m_2 y \sqrt{s_2}$
\begin{align*}
  \sqrt{s_1 s_2} + (y^2 - r_2 m_2 y - k) &= \pm (x - r_2) \sqrt{s_1} \pm m_2 y \sqrt{s_2}\\
\end{align*}
Raise to the power of 2 each side
\begin{align*}
  s_1 s_2 + (y^2 - r_2 m_2 y - k)^2 + 2 (y^2 - r_2 m_2 y - k) \sqrt{s_1 s_2}
  &= (x - r_2)^2 s_1 + m_2^2 y^2 s_2 + 2 m_2 y (x - r_2) \sqrt{s_1 s_2}\\
  &= (x - r_2)^2 s_1 + m_2^2 y^2 s_2 + 2 (m_2 x y - r_2 m_2 y) \sqrt{s_1 s_2}\\
\end{align*}
Exchange
\begin{align*}
  s_1 s_2 + (y^2 - r_2 m_2 y - k)^2 - (x - r_2)^2 s_1 - m_2^2 y^2 s_2
  &= 2 (m_2 x y - r_2 m_2 y - y^2 + r_2 m_2 y + k) \sqrt{s_1 s_2})\\
  &= 2 (m_2 x y - y^2 + k) \sqrt{s_1 s_2})\\
\end{align*}
Raise again
\begin{align*}
  (s_1 s_2 + (y^2 - r_2 m_2 y - k)^2 - (x - r_2)^2 s_1 - m_2^2 y^2 s_2)^2 = 4 (m_2 x y - y^2 + k)^2 s_1 s_2\\
\end{align*}
Exchange and substitute
\begin{align*}
  4 (m_2 x y - y^2 + k)^2 s_1 s_2
  &= ((d_1^2 - y^2) s_2 + (y^2 - r_2 m_2 y - k)^2 - (x - r_2)^2 (d_1^2 - y^2) - m_2^2 y^2 s_2)^2\\
  &= (\\
  & ~+ s_2 (d_1^2 - y^2 - m_2^2 y^2)\\
  & ~+ r_2^2 (y^2 - d_1^2 + m_2^2 y^2)\\
  & ~+ r_2 (2 m_2 k y - 2 m_2 y^3 + 2 (d_1^2 - y^2))\\
  & ~+ y^4 + k^2 - 2 k y^2 - d_1^2 x^2 + x^2 y^2\\
  & ~)^2\\
\end{align*}
Multiply by $(1 + m_2^2)^4$
\begin{align*}
  4 (m_2 x y - y^2 + k)^2 (1 + m_2^2)^4 s_1 s_2
  &= (\\
  & ~+ (1 + m_2^2)^2 s_2 (d_1^2 - y^2 - m_2^2 y^2)\\
  & ~+ (1 + m_2^2)^2 r_2^2 (y^2 - d_1^2 + m_2^2 y^2)\\
  & ~+ (1 + m_2^2)^2 r_2 (2 m_2 k y - 2 m_2 y^3 + 2 (d_1^2 - y^2))\\
  & ~+ (1 + m_2^2)^2 (y^4 + k^2 - 2 k y^2 - d_1^2 x^2 + x^2 y^2)\\
  & ~)^2\\
  &= (\\
  & ~+ (1 + m_2^2)^2 \frac{2 m_2 x y - y^2 + d_2^2 - m_2^2 x^2 + d_2^2 m_2^2}{(1 + m_2^2)^2} (d_1^2 - y^2 - m_2^2 y^2)\\
  & ~+ (1 + m_2^2)^2 \frac{(x + m_2 y)}{1 + m_2^2}^2 (y^2 - d_1^2 + m_2^2 y^2)\\
  & ~+ (1 + m_2^2)^2 \frac{(x + m_2 y)}{1 + m_2^2} (2 m_2 k y - 2 m_2 y^3 + 2 (d_1^2 - y^2))\\
  & ~+ (1 + m_2^2)^2 (y^4 + k^2 - 2 k y^2 - d_1^2 x^2 + x^2 y^2)\\
  & ~)^2\\
  &= (\\
  & ~+ (2 m_2 x y - y^2 + d_2^2 - m_2^2 x^2 + d_2^2 m_2^2) (d_1^2 - y^2 - m_2^2 y^2)\\
  & ~+ (x + m_2 y)^2 (y^2 - d_1^2 + m_2^2 y^2)\\
  & ~+ (1 + m_2^2) (x + m_2 y) (2 m_2 k y - 2 m_2 y^3 + 2 (d_1^2 - y^2))\\
  & ~+ (1 + m_2^2)^2 (y^4 + k^2 - 2 k y^2 - d_1^2 x^2 + x^2 y^2)\\
  & ~)^2\\
  &= (\\
  & ~+ 2 d_1^2 m_2 x y - d_1^2 y^2 + d_1^2 d_2^2 - d_1^2 m_2^2 x^2 + d_1^2 d_2^2 m_2^2\\
  & ~- 2 m_2 x y^3 + y^4 - d_2^2 y^2 + m_2^2 x^2 y^2 - d_2^2 m_2^2y^2\\
  & ~- 2 m_2^3 x y^3 + m_2^2 y^4 - d_2^2 m_2^2 y^2 + m_2^4 y^4 - d_2^2 m_2^4 y^2\\
  & ~+ y^2 x^2 - d_1^2 x^2 + m_2^2 x^2 y^2\\
  & ~+ m_2^2 y^4 - d_1^2 m_2^2 y^2 + m_2^4 y^4\\
  & ~+ 2 m_2 x y^3 - 2 d_1^2 m_2 x y - 2 m_2^3 x y^3\\
  & ~+ (x + m_2 y + m_2^2 x + m_2^3 y) (2 m_2 k y - 2 m_2 y^3 + 2 d_1^2 - 2 y^2)\\
  & ~+ (1 + m_2^4 + 2 m_2^2) (y^4 + k^2 - 2 k y^2 - d_1^2 x^2 + x^2 y^2)\\
  & ~)^2\\
\end{align*}
\begin{align*}
  4 (m_2 x y - y^2 + k)^2 (1 + m_2^2)^4 s_1 s_2
  &= (\\
  & ~+ 2 d_1^2 m_2 x y - d_1^2 y^2 + d_1^2 d_2^2 - d_1^2 m_2^2 x^2 + d_1^2 d_2^2 m_2^2\\
  & ~- 2 m_2 x y^3 + y^4 - d_2^2 y^2 + m_2^2 x^2 y^2 - d_2^2 m_2^2y^2\\
  & ~- 2 m_2^3 x y^3 + m_2^2 y^4 - d_2^2 m_2^2 y^2 + m_2^4 y^4 - d_2^2 m_2^4 y^2\\
  & ~+ y^2 x^2 - d_1^2 x^2 + m_2^2 x^2 y^2\\
  & ~+ m_2^2 y^4 - d_1^2 m_2^2 y^2 + m_2^4 y^4\\
  & ~+ 2 m_2 x y^3 - 2 d_1^2 m_2 x y - 2 m_2^3 x y^3\\
  & ~+ 2 m_2 k x y - 2 m_2 x y^3 + 2 d_1^2 x - 2 x y^2\\
  & ~+ 2 m_2^2 k y^2 - 2 m_2^2 y^4 + 2 d_1^2 m_2 y - 2 m_2 y^3\\
  & ~+ 2 m_2^3 k x y - 2 m_2^3 x y^3 + 2 d_1^2 m_2^2 x - 2 m_2^2 x y^2\\
  & ~+ 2 m_2^4 k y^2 - 2 m_2^4 y^4 + 2 d_1^2 m_2^3 y - 2 m_2^3 y^3\\
  & ~+ y^4 + k^2 - 2 k y^2 - d_1^2 x^2 + x^2 y^2\\
  & ~+ m_2^4 y^4 + k^2 m_2^4 - 2 m_2^4 k y^2 - d_1^2 m_2^4 x^2 + m_2^4 x^2 y^2\\
  & ~+ 2 m_2^2 y^4 + 2 k^2 m_2^2 - 4 m_2^2 k y^2 - 2 d_1^2 m_2^2 x^2 + 2 m_2^2 x^2 y^2\\
  & ~)^2
\end{align*}
\begin{align*}
  4 (m_2 x y - y^2 + k)^2 (1 + m_2^2)^4 s_1 s_2
  &= 4 (m_2 x y - y^2 + k)^2 (1 + m_2^2)^4 (d_1^2 - y^2) \frac{2 m_2 x y - y^2 + d_2^2 - m_2^2 x^2 + d_2^2 m_2^2}{(1 + m_2^2)^2}\\
  &= 4 (m_2 x y - y^2 + k)^2 (1 + m_2^2)^2 (d_1^2 - y^2) (2 m_2 x y - y^2 + d_2^2 - m_2^2 x^2 + d_2^2 m_2^2)\\
  &= 4\\
  &  (m_2 x y - y^2 + k)^2 \\
  &  (1 + m_2^2)^2 \\
  &  (d_1^2 - y^2) \\
  &  (2 m_2 x y - y^2 + d_2^2 - m_2^2 x^2 + d_2^2 m_2^2)\\
  &= 4\\
  &  (m_2^2 x^2 y^2 + y^4 + k^2 - 2 m_2 x y^3 + 2 m_2 k x y - 2 k y^2) \\
  &  (1 + m_2^4 + 2 m_2^2) \\
  &  (d_1^2 - y^2) \\
  &  (2 m_2 x y - y^2 + d_2^2 - m_2^2 x^2 + d_2^2 m_2^2)\\
  &= 4\\
  & + (d_1^2 m_2^2 x^2 y^2 + d_1^2 y^4 + d_1^2 k^2 - 2 m_2 d_1^2 x y^3 + 2 m_2 d_1^2 k x y - 2 kd_1^2  y^2\\
  & + d_1^2 m_2^6 x^2 y^2 + d_1^2 m_2^4 y^4 + d_1^2 m_2^4 k^2 - 2 d_1^2 m_2 m_2^4 x y^3 + 2 d_1^2 m_2 m_2^4 k x y - 2 d_1^2 m_2^4 k y^2\\
  & + 2 d_1^2 m_2^24 x^2 y^2 + 2 d_1^2 m_2^2 y^4 + 2 d_1^2 m_2^2 k^2 - 4 d_1^2 m_2^3 x y^3 + 4 d_1^2 m_2^3 k x y - 4 d_1^2 m_2^2 k y^2\\
  & - m_2^2 x^2 y^4 - y^6 - k^2 y^2 + 2 m_2 x y^5 - 2 m_2 k x y^3 + 2 k y^4\\
  & - m_2^6 x^2 y^4 - m_2^4 y^6 - m_2^4 k^2 y^2 + 2 m_2 m_2^4 x y^5 - 2 m_2 m_2^4 k x y^3 +- 2 m_2^4 k y^4\\
  & - 2 m_2^24 x^2 y^3 - 2 m_2^2 y^6 - 2 m_2^2 k^2 +y^2  4 m_2^3 x y^5 - 4 m_2^3 k x y^3 + 4 m_2^2 k y^4)\\
  & (2 m_2 x y - y^2 + d_2^2 - m_2^2 x^2 + d_2^2 m_2^2)\\
 \end{align*}


%%   (
%%     + 2 y^4
%%     + 2 m_2^2 y^4
%%     + m_2^4 y^4

%%     - 6 m_2^3 x y^3
%%     - 2 m_2 x y^3
%%     - 2 m_2 y^3

%%     + 2 x^2 y^2
%%     + m_2^4 x^2 y^2
%%     + 4 m_2^2 x^2 y^2

%%     - 2 d_1^2 x^2
%%     - d_1^2 m_2^4 x^2
%%     - 3 d_1^2 m_2^2 x^2

%%     - 2 k y^2
%%     - d_1^2 y^2
%%     - d_2^2 y^2
%%     - 2 d_2^2 m_2^2 y^2
%%     - d_1^2 m_2^2 y^2
%%     - d_2^2 m_2^4 y^2
%%     - 2 m_2^2 k y^2

%%     - 2 x y^2
%%     - 2 m_2^2 x y^2

%%     + 2 m_2 k x y
%%     + 2 m_2^3 k x y

%%     + 2 d_1^2 m_2 y

%%     + 2 d_1^2 x
%%     + 2 d_1^2 m_2^2 x

%%     + 2 d_1^2 m_2^3 y

%%     + d_1^2 d_2^2
%%     + d_1^2 d_2^2 m_2^2
%%     + k^2
%%     + k^2 m_2^4
%%     + 2 m_2^2 k^2
%%   )^2
\end{document}
